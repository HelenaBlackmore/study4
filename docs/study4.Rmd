---
title: "study 4 data analysis"
output:
  rmdformats::material:
    code_folding: hide
    css: "style.css"

---
<!-- run this to knit:

rmarkdown::render('study4.Rmd',
                  output_file = paste('index.html'))
                                                          
                                                          -->

# Tidy data

## Set-up
```{r setup, echo=TRUE, warning=FALSE, message=FALSE}

knitr::opts_chunk$set(
	echo = TRUE,
	error = FALSE,
	message = FALSE,
	warning = FALSE
)
library(afex)
library(tidyverse)
library(kableExtra)
library(knitr)
library(plotly)
library(broom)
library(wesanderson)
library(robust)
library(ggparl)
library(mediation)

set.seed(2022)

```
## Read data
```{r read_data}
# reads excel data sheet

data <- read.csv("../data/study4.csv") # reads data
data_sat <- read.csv("../data/raw/stage3_satisfaction.csv") # reads in satisfaction data



# summary(data) # explore the data types, missing data and typos

data <- data %>%
  mutate(gender = ifelse(gender == "m", "m", "f")) # corrects an issuewith extra space in "f "

data$gender <- as.factor(data$gender)
data$pp_number <- as.factor(data$pp_number)
data$condition <-as.factor(data$condition)


# mood data
mood1 <- read.csv("../data/raw/stage1_mood.csv") %>%
  dplyr::select(subject, stimulusitem2, response)%>%
  rename(response1=response, feeling = stimulusitem2)%>%
  mutate(stage = 1)%>%
  filter(subject != 6666)

mood2 <- read.csv("../data/raw/stage2_mood.csv") %>%
  dplyr::select(subject, stimulusitem2,  response)%>%
  rename(response2=response,  feeling = stimulusitem2)%>%
  mutate(stage = 2)%>%
  filter(subject != 6666)

mood3 <- read.csv("../data/raw/stage3_mood.csv") %>%
  dplyr::select(subject, stimulusitem2, response) %>%
  rename(response3=response,  feeling = stimulusitem2)%>%
  mutate(stage = 3)%>%
  filter(subject != 6666)

mood_dat <- inner_join( mood1, mood2,
                        by = c("subject", "feeling"), 
                        keep = FALSE)%>%
            inner_join(., mood3,
                       by = c("subject", "feeling"),
                       keep = FALSE)%>%
            dplyr::select(- starts_with("stage")) %>%
            pivot_longer(cols = response1:response3,
                         names_to ="stage",
                         values_to = "rating")%>%
            pivot_wider(names_from = "feeling",
                        values_from ="rating" )%>%
            mutate(alert = (alert +strong + `clear-headed` + `well-coordinated` + energetic + `quick-witted` + attentive + proficient + interested )/9,
                   content =(contented + tranquil + amicable + gregarious)/4,
                   calm =(calm + relaxed)/2)




#`clear-headed` + `well-coordinated` + energetic + `quick-witted` + attentive + proficient + interested

# qualtrics data 
      #mainly info about drinking

data_q<- read.csv("../data/other/study_4Q.csv")%>%
  dplyr::select(Q21, gender, age, Q15, Q16)%>%
  rename(subject = Q21, 
         units = Q15, 
         units_beer = Q16)%>%
  mutate(subject = as.numeric(subject),
         condition = subject %/% 1000)%>%
  filter(!is.na(subject))%>%
  mutate(subject = as.factor(subject), 
         gender=as.factor(gender), 
         age = as.numeric(age), 
         units = as.numeric(units), 
         units_beer = as.numeric(units_beer))%>%
  filter( subject != "6666")


# expectations & perception of taste/flavour

taste_dat <- read.csv("../data/raw/stage1_perception.csv")%>%
  dplyr::select(subject, trialcode, response)%>%
  rename(Epercept = trialcode, expected = response)

taste_dat$Epercept<- as.factor(taste_dat$Epercept)
  

expect_dat<- read.csv("../data/raw/stage1_expectations.csv")%>%
  dplyr::select(subject, trialcode, response, stimulusitem3)%>%
  filter(stimulusitem3 == "extremely")%>%
  dplyr::select(- stimulusitem3)%>%
  rename(percept = trialcode, perceived = response)

expect_dat$percept<- as.factor(expect_dat$percept)


# satisfaction data
  #merge data_sat and expect_dat

satis_datP <- data_sat %>% 
  dplyr::select(subject, trialcode, response)%>%
  dplyr::filter(trialcode == "VAS")

satis_datE <- expect_dat %>%
  dplyr::filter(percept == "VAS_satisE_VAS")


wtp_dat <- data_sat %>%
  filter(trialcode == "VAS_wtp")%>%
  dplyr::select(subject, response)


# ITT data

itt_s1 <-read.csv("../data/summaries/stage1_ITT.csv")%>%
  dplyr::select(script.subjectid, expressions.propcorrect_stim1:expressions.propcorrect_stim13)%>%
  mutate(stage1 = 1)%>%
  rename(subject = script.subjectid)%>%
  rename_at(vars(matches("^expressions")), ~ str_remove(.,"^expressions.propcorrect_")) %>%
  pivot_longer(cols = starts_with("stim") , 
               names_to = "stimulus" ,
               values_to = "correct")


itt_s2 <-read.csv("../data/summaries/stage2_ITT.csv")%>%
  dplyr::select(script.subjectid, expressions.propcorrect_stim1:expressions.propcorrect_stim13)%>%
  mutate(stage2 = 2)%>%
  rename(subject = script.subjectid)%>%
  rename_at(vars(matches("^expressions")), ~ str_remove(.,"^expressions.propcorrect_"))%>%
  pivot_longer(cols = starts_with("stim") , 
               names_to = "stimulus" ,
               values_to = "correct")

itt_s3 <-read.csv("../data/summaries/stage3_ITT.csv")%>%
  dplyr::select(script.subjectid, expressions.propcorrect_stim1:expressions.propcorrect_stim13)%>%
  mutate(stage3 = 3)%>%
  rename(subject = script.subjectid)%>%
  rename_at(vars(matches("^expressions")), ~ str_remove(.,"^expressions.propcorrect_"))%>%
  pivot_longer(cols = starts_with("stim") , 
               names_to = "stimulus" ,
               values_to = "correct")

itt_dat <- inner_join(itt_s1, itt_s2,
                      by = c("subject","stimulus"),
                      keep = FALSE,
                      suffix = c(".1", ".2"))%>%
          inner_join(., itt_s3,
                     by = c("subject", "stimulus"),
                     keep = FALSE) %>%
  pivot_longer(cols = starts_with("correct") ,
               names_to = "stage",
               values_to = "correct")%>%
  dplyr::select(-c( stage1, stage2, stage3))%>%
  mutate( stage = case_when(stage == "correct.1" ~ 'stage 1',
                            stage == "correct.2" ~ "stage 2",
                            stage == "correct" ~ "stage 3"))%>%
   mutate(condition = subject %/% 1000) %>%
  mutate(alcohol = if_else((condition%%2)==1, "alcoholic", "non-alcoholic"))%>%
  mutate(focus = case_when(condition == 1 ~ 'control',
                           condition == 2 ~ 'control',
                           condition == 3 ~ 'hedonic',
                           condition == 4 ~ 'hedonic',
                           condition == 5 ~ 'utilitarian',
                           condition == 6 ~ 'utilitarian'))
  

```
## Data joins
```{r joining data}

DA <- data %>%
  dplyr::select(pp_number, BMI)%>%
  rename(subject = pp_number)

DB <- data_sat %>%
  dplyr::select(subject, response, trialcode ) %>%
  mutate(row = row_number(), subject = as.factor(subject)) %>%
  pivot_wider(names_from = trialcode, values_from = response) %>%
  rename( wtp = VAS_wtp)%>%
  dplyr::select(- row)


D1 <- inner_join( DA,DB,
                  by = "subject",
                  keep = FALSE
                ) %>%
    pivot_longer(cols =c(VAS, wtp) , 
                 names_to = "measure", 
                 values_to = "rating") %>%
    inner_join(., data_q,
             by = "subject", 
             keep = FALSE)%>%
  filter(!is.na(rating))
                                            # long dataset incl,. info about satisfaction and willingness to pay by condition, and alcohol/ non-alcohol
# need to add focus condition


#Joining mood data

D2 <- inner_join(mood1, mood2, 
                 by = c("subject", "feeling"),
                 keep = FALSE) %>%
  inner_join(., mood3,
             by = c("subject","feeling"),
             keep = FALSE)%>%
            dplyr::select(- starts_with("stage")) %>%
  mutate(condition = subject  %/% 1000) %>%
  pivot_longer(cols = starts_with("response"),
   names_to = "stage",
   names_prefix = "response",
   values_to = "rating")
  

D3_dat <- inner_join(expect_dat, taste_dat,
                     by = "subject",
                     keep = FALSE)%>%
  mutate(condition = subject %/% 1000) %>%
  pivot_wider(names_from = percept,
    values_from = perceived) %>%
  pivot_wider(names_from = Epercept,
              values_from = expected)%>%
  rename_at(vars(matches("^VAS\\_")), ~ str_remove(.,"^VAS\\_"))%>%
  rename_at(vars(matches("_VAS")), ~ str_remove(.,"_VAS")) %>%
  mutate(alcohol = if_else((condition%%2)==1, "alcoholic", "non-alcoholic"))%>%
  mutate(focus = case_when(condition == 1 ~ 'control',
                           condition == 2 ~ 'control',
                           condition == 3 ~ 'hedonic',
                           condition == 4 ~ 'hedonic',
                           condition == 5 ~ 'utilitarian',
                           condition == 6 ~ 'utilitarian'))
  


D3_dat$alcohol<- as.factor(D3_dat$alcohol)
D3_dat$focus<- as.factor(D3_dat$focus)
D3_dat$condition <- as.factor(D3_dat$condition)


satis_dat <- inner_join(satis_datE, satis_datP,
                        by = "subject",
                        keep = FALSE)%>%
              dplyr::select(subject, perceived, response,)%>%
            rename(satisE = perceived, satis = response)%>%
              inner_join(., wtp_dat,
                         by = "subject",
                         keep = FALSE)%>%
            rename(wtp = response) %>%
  mutate(condition = subject %/% 1000) %>%
  mutate(alcohol = if_else((condition%%2)==1, "alcoholic", "non-alcoholic"))%>%
  mutate(focus = case_when(condition == 1 ~ 'control',
                           condition == 2 ~ 'control',
                           condition == 3 ~ 'hedonic',
                           condition == 4 ~ 'hedonic',
                           condition == 5 ~ 'utilitarian',
                           condition == 6 ~ 'utilitarian'))
  
  

```


# Descriptive analyses

## Differences between conditions

```{r pp descriptives}

# gender
total_n <- nrow(data)
males <- data_q%>%filter(gender == "male") %>% nrow()
females <- data_q%>%filter(gender == "female") %>% nrow()
nonbinary <- data_q %>% filter(gender== "non-binary" )%>% nrow()



# by condition
gender_tib <- D1 %>% 
  filter(measure == "wtp") %>% # avoids duplicating data
  group_by( condition) %>%
  summarise(n=n(),
            BMI = mean(BMI, na.rm = TRUE), 
            age = mean(age, na.rm = TRUE)) %>% 
  kable()


```

### Gender

```{r gender_conditions}
xtabs(~ gender + condition , data = data_q,drop.unused.levels = TRUE)%>%
  kable(digits = 2, caption = "A contingency table with observed gender values/counts across conditions") %>%
  kable_styling(full_width = TRUE, 
                position = "left")

chi_test <- chisq.test(data_q$gender, data_q$condition, simulate.p.value = TRUE)

chi_test$expected %>%
  kable(digits = 1, caption = "A contingency table of expected gender values/counts across conditions")%>%
  kable_styling(full_width = TRUE,
                position = "left")
  

#  χ2 test requires all expected frequencies to be greater than five --> simulate.p.value avoids the problem

```

Altogether `r total_n` participants took part in the study, as is common for psychology studies, most of these were women (`r females` self-identified as female, `r males` as male and `r nonbinary` as non-binary). The gender split across the conditions was not problematic $\chi^2$ = `r round(chi_test$statistic,2)`, *p* = `r round(chi_test$p.value,3)` (simulated *p* values based on 2000 replicates, as expected values << 5).


```{r gender_conditions_plot, fig.cap= "Number of participants in each conditions"}
# plot
## bar plot is best here
gender_pal <- c("#d62828", "#003049", "#9d69a3")
gender_cond_plot <-
  ggplot(data = data_q)+
  geom_bar(aes(x= condition, fill = gender))+
  scale_fill_manual(values = gender_pal) +
  scale_y_continuous(name="", limits=c(0, 40), breaks = seq(0,40, 5)) +
  scale_x_discrete(name = "conditions", breaks = seq(1,6,1), limits = c("1", "2", "3", "4", "5", "6"))+
  theme(panel.grid = element_blank())+
  theme_minimal()

 ggplotly(gender_cond_plot)  

```

### Age
```{r age_conditions}
data_desc <- D1 %>%
  filter(measure == "wtp")

age_lm <- lm(age ~ condition, data=data_desc)

age_sum <- broom::tidy(age_lm)
age_glance <- broom::glance(age_lm)
```

Participants' age ranged between `r min(data_desc$age, na.rm = TRUE)` and `r max(data_desc$age, na.rm = TRUE)`. Most participants were very young and the mean age of participants was `r round(mean(data_desc$age, na.rm = TRUE),1)` (*sd* = `r round(sd(data_desc$age, na.rm = TRUE),1)`). The age did not significantly differ across the six conditions F(`r age_glance$df.residual`, `r age_glance$df`) = `r round(age_glance$statistic,2)`, *p* = `r round(age_glance$p.value,3)`.

```{r age, fig.cap= "Participants' age by condition and gender. Note range of the y-axis "}


age_plot <- ggplot(data= data_desc, aes(x=condition, y = age, group = condition) )+
  geom_boxplot(fill= "#6c757d", alpha = 0.5, outlier.shape = NA) +
  geom_jitter(shape=16, position=position_jitter(0.2), aes(color = gender))+
  scale_y_continuous(name="age", limits=c(18, 60), breaks = seq(0,60, 10)) +
  scale_x_discrete(name = "conditions", limits = c("1", "2", "3", "4", "5", "6"))+
  scale_color_manual(values = gender_pal) +
  theme_minimal()

age_plot2 <- ggplot(data= data_desc, aes(x=condition, y = age, group = condition) )+
  geom_boxplot(fill= "#6c757d", alpha = 0.5, outlier.shape = NA) +
  geom_jitter(shape=16, position=position_jitter(0.2), aes(color = gender))+
  scale_y_continuous(name="age", limits=c(15, 30), breaks = seq(15,30,5)) +
  scale_x_discrete(name = "conditions", limits = c("1", "2", "3", "4", "5", "6"))+
  scale_color_manual(values = gender_pal) +
  theme_minimal()

ggplotly(age_plot)
ggplotly(age_plot2)
```


### BMI
```{r BMI_conditions}

bmi_lm <- lm(BMI ~ condition, data=data_desc)

bmi_glance <- broom::glance(bmi_lm)

```

The participants' BMI ranged between `r round(min(data_desc$BMI, na.rm = TRUE),1)` - `r round(max(data_desc$BMI, na.rm = TRUE),1)`. The average BMI was `r round(mean(data_desc$BMI, na.rm = TRUE),1)` (*sd* =`r round(sd(data_desc$BMI,na.rm = TRUE),1)`) and again, this did not differ across conditions F(`r bmi_glance$df.residual`, `r bmi_glance$df`) = `r round(bmi_glance$statistic,2)`, *p* = `r round(bmi_glance$p.value, 3)`.

```{r BMI, fig.cap=" Participants' BMI by condition and gender"}
BMI_plot <- ggplot(aes(x=condition, y = BMI), data= data_desc)+
  geom_boxplot(fill= "#6c757d", alpha = 0.5) +
  geom_jitter(shape=16, position=position_jitter(0.2), aes(color = gender))+
  scale_y_continuous(name="BMI", limits=c(18, 35), breaks = seq(0,35, 10)) +
  scale_x_discrete(name = "conditions", limits = c("1", "2", "3", "4", "5", "6"))+
  scale_color_manual(values = gender_pal) +
  theme_minimal()

ggplotly(BMI_plot)

```



### Baseline mood

Visual inspection of participants' baseline mood does not give raise to any concerns. *Do I need to run 16 anovas? Does not seem necessary...)*
```{r mood_conditions_plot, fig.cap= "Participants' baseline mood ratings"}
mood_base <- D2 %>%
  filter(stage == 1)

palette <- c("#033f63","#28666e","#7c9885","#b5b682","#fedc97","#e5e1ee","#c17767","#210203","#eb9486","#82204a", "#0a2342","#2ca58d","#84bc9c","#fffdf7","#f46197","#fec601")

ggplot(data = mood_base, aes(x=condition, y = rating, group = condition, fill = feeling))+
  geom_boxplot()+
  facet_wrap("feeling")+
  scale_fill_manual(values = palette) +
  scale_y_continuous(name="", limits=c(0, 100), breaks = seq(0,100, 20)) +
  theme(panel.grid = element_blank())+
  theme_minimal()
  

```


### Drinking

#### alcohol consumption

```{r alcohol_consumption, include = FALSE}

pp_over14units <-data_q %>% filter(units>14)%>%nrow() # no. of pp consuming more than 14 units of alcohol a week

# statistical analysis

al_cons_lm <- lmRob(units ~ condition, data= data_q)
al_model<-summary(al_cons_lm)
al_a<-anova(al_cons_lm)

beer_cons_lm <-lmRob(units_beer ~ condition, data = data_q)
beer_model<-summary(beer_cons_lm)
beer_a<-anova(beer_cons_lm)
```
While the average alcohol consumption was realtively low `r round(mean(data_q$units),1)` (*sd* = `r round(sd(data_q$units),1)`), there was a considerable differences among participants. The lowest alcohol consumption was only `r min(data_q$units)`, equivalent to a half a pint of light beer (3.5%) once a week, the highest alcohol consumption was `r max(data_q$units)` units of alcohol a week, which is equivalent to over 20 pints of strong (~5% abv) beer every week. Interestingly, `r pp_over14units ` (`r round((pp_over14units/total_n)*100,1)`%) participants consumed more than the recommended 14 units a week. We also asked participants to estimate how many units of beer they consumed. This was on average `r round(mean(data_q$units_beer),1)` (*sd* = `r round(sd(data_q$units_beer),1)`), this  however varied between `r min(data_q$units_beer)` and  `r max(data_q$units_beer)`. Thefigures below show participants' weekly alcohol consumption, weekly beer consumption and the proportion of units of alcohol that came from beer. Neither the overall alcohol consumption nor beer consumption differed significantly across the conditions, F(`r al_model$df[1] `, `r al_model$df[2] `) = `r round(al_a$RobustF[2],2)`, *p* = `r round(al_a$"Pr(F)"[2],3)` and F(`r beer_model$df[1] `, `r beer_model$df[2] `) = `r round(beer_a$RobustF[2],2)`, *p* = `r round(beer_a$"Pr(F)"[2],3)`, respectively. 

```{r alcohol_plot, fig.cap="participants' alcohol consumption by condition"}

# plot units alcohol consumption by condition

units_plot<-ggplot(aes(x=condition, 
           y = units, 
           group = condition), 
           data= data_q)+
  geom_hline(aes(yintercept = 14, linetype = "14 units/week"),
             color = "red")+
  scale_linetype_manual(name = "max. recommended\nalcohol consumption", values = c(2, 2),
                      guide = guide_legend(override.aes = list(color = c("red")), title.theme = element_text(size = 8, face = "bold" ) ))+
  geom_boxplot(fill= "#6c757d", 
               alpha = 0.5, 
               outlier.shape = NA) +
  geom_jitter(shape=16, 
              position=position_jitter(0.2), 
              aes(color = gender))+
  scale_y_continuous(name="alcohol consumption\n(units)", 
                     limits=c(0, 75), 
                     breaks =   seq(0,75, 5)) +
  scale_x_discrete(name = "conditions", 
                   limits = c("1", "2", "3", "4", "5", "6"))+
  scale_color_manual(values = gender_pal) +
  theme_minimal()

ggplotly(units_plot)

```

```{r beer_plot, fig.cap="participants' beer consumption by condition"}
# plot units beer consumption by condition

beer_plot<-ggplot(aes(x=condition, 
           y = units_beer, 
           group = condition), 
           data= data_q)+
  geom_boxplot(fill= "#6c757d", 
               alpha = 0.5, 
               outlier.shape = NA) +
  geom_jitter(shape=16, 
              position=position_jitter(0.2), 
              aes(color = gender))+
  scale_y_continuous(name="beer consumption\n(units)", 
                     limits=c(0, 35), 
                     breaks =   seq(0,35, 5)) +
  scale_x_discrete(name = "conditions", 
                   limits = c("1", "2", "3", "4", "5", "6"))+
  scale_color_manual(values = gender_pal) +
  theme_minimal()

ggplotly(beer_plot)

```

```{r beer_prop_plot, fig.cap="% of alcohol consumption that is beer by condition"}

summary_beer <- data_q %>%
   pivot_longer(cols = starts_with("units"),  names_to = "al_id", values_to = "units") %>%
   mutate(al_id = ifelse(al_id =="units", "all", "beer"))%>%
   group_by(condition, al_id)%>%
   summarize(units = mean(units))%>%
  pivot_wider(names_from = al_id, values_from = units)%>%
  mutate(perc= (beer/all)*100)%>%
  pivot_longer(cols = c(all, beer), names_to = "alcohol", values_to = "units")

al_pal <- c( "#1d3557","#f4a261")
  
beer_prop <- ggplot(data=summary_beer, 
       aes(x=condition,
           y=units, 
           fill = alcohol)) +
  geom_bar(stat="identity", 
           position=position_dodge())+
  geom_text(aes(label =paste0(round(perc,1),"%") ), 
             data = summary_beer %>%filter(alcohol == "beer"), 
             show.legend = FALSE,
             size = 2, 
             nudge_x = 0.3, 
             nudge_y = 1,
             color = "#1d3557" )+
  scale_fill_manual(values = al_pal)+
  scale_y_continuous(name="alcohol consumption\n(units)", 
                     limits=c(0, 15), 
                     breaks =   seq(0,15, 5)) +
  scale_x_discrete(name = "conditions", 
                   limits = c("1", "2", "3", "4", "5", "6"))+
  labs( fill = "alcohol")+
  theme_minimal()

ggplotly(beer_prop)
```

# Expectations & Gustatory Perception

- structural equation modelling
- gustatory data (expected and perceived are in )
- because of independent measures design we can use the `mediation` package, function `mediate()`
  **some resources and documentation **
  - https://ademos.people.uic.edu/Chapter14.html#24_method_2:_the_mediation_pacakge_method
  - https://imai.fas.harvard.edu/research/files/mediationR2.pdf

## Bitterness

- no direct or indirect effect of focus or alcoholcontent on perceived orexpected bitterness

```{r bitter_mediate}
bitter_dat <- D3_dat%>%
  dplyr::select(subject, alcohol, focus, condition, bitterE, bitter)
   # prep dataset

# model m A --> M
mbm <- lm(bitterE ~ focus*alcohol, data = bitter_dat)

# model A--> B
mby <-lm(bitter ~ bitterE + focus*alcohol,  data = bitter_dat)

# robustSE = TRUE to get heteroscedasticity consistent SE
# nonparametric bootstrap rather than the quasi-Bayesian Monte
# Carlo simulation for variance estimation via the boot = TRUE argument
# also entering alcohol/focus as a covariate

broom::tidy(mbm)
med_bitter_focusH <- mediate(mbm, mby, 
                            sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "bitterE",
                            covariates = "alcohol",
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "hedonic",)

med_bitter_focusU <- mediate(mbm, mby, 
                            sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "bitterE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "utilitarian")


summary(med_bitter_focusH)
plot(med_bitter_focusH)

summary(med_bitter_focusU)
plot(med_bitter_focusU)

med_bitter_alcohol <- mediate(mbm, mby, 
                              sims = 1000, 
                              boot.ci.type = "perc", 
                              treat = "alcohol", 
                              mediator = "bitterE",
                              robustSE = TRUE, 
                              boot = TRUE,
                              conf.level = 0.95, 
                              covariates = "focus", 
                              control.value = "alcoholic", 
                              treat.value = "non-alcoholic")

summary(med_bitter_alcohol)
plot(med_bitter_alcohol)
```

```{r bitter_plot, fig.cap = "Expected and perceived ratings of bitterness \n errorbars indicate 95% CI (1.96 SE)"}

bitter_tib <-bitter_dat %>%
  pivot_longer(cols = starts_with("bitter"),
               names_to = "bitter",
               values_to = "rating")%>%
  group_by(alcohol, focus,bitter)%>%
  summarise(n = n(),
            meanB = mean(rating, na.rm = TRUE),
            sdB = sd(rating, na.rm = TRUE),
            ci_lo = meanB - 1.96 * sdB/sqrt(n),
            ci_hi = meanB + 1.96 * sdB/sqrt(n))%>%
  filter(!is.na(focus))

rating_labs <- c("perceived", "expected")
names(rating_labs) <- c("bitter", "bitterE")

bitter_plot<-ggplot(aes(x= focus, y = meanB, fill = alcohol), data = bitter_tib ) +
  facet_grid(~ bitter, 
             labeller = labeller(bitter = rating_labs))+
   geom_bar(stat="identity", position=position_dodge())+
  geom_errorbar(aes(ymin=ci_lo, ymax=ci_hi), width=.2,
                 position=position_dodge(.9))+
  scale_y_continuous(name="bitterness", 
                     limits=c(0, 100), 
                     breaks =   seq(0,100, 25)) +
  scale_x_discrete(name = "focus" )+
  scale_fill_manual(values = gender_pal) +
  theme_minimal()

ggplotly(bitter_plot)

```

## Refreshment
- no direct or indirect effect of focus/ alcohol content on perceived refreshment
- focus on effects of drink --> increased expectations of refreshment, but did not affect perception

```{r refreshment_mediate}
refresh_dat <- D3_dat%>%
  dplyr::select(subject, alcohol, focus, condition, refreshmentE, refreshment)
   # prep dataset

# model m A --> M
mrm <- lm(refreshmentE ~ focus*alcohol, data = refresh_dat)

# model A--> B
mry <-lm(refreshment ~ refreshmentE + focus*alcohol,  data = refresh_dat)

broom::tidy(mrm)%>%
  kable(digits = 3, caption = "effect of alcohol and focus on expected refreshment")%>%
  kable_styling(full_width = TRUE)

med_refreshment_focusH <- mediate(mrm, mry, 
                                  sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "refreshmentE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "hedonic")

summary(med_refreshment_focusH)
plot(med_refreshment_focusH)

med_refreshment_focusU <- mediate(mrm, mry, 
                                  sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "refreshmentE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "utilitarian")

summary(med_refreshment_focusU)
plot(med_refreshment_focusU)


med_refreshment_alcohol <- mediate(mrm, mry,
                                   sims = 1000, 
                                  boot.ci.type = "perc", 
                                  treat = "alcohol", 
                                  mediator = "refreshmentE",
                                  robustSE = TRUE, 
                                  boot = TRUE,
                                  conf.level = 0.95, 
                                  covariates = "focus", 
                                  control.value = "alcoholic", 
                                  treat.value = "non-alcoholic")

summary(med_refreshment_alcohol)
plot(med_refreshment_alcohol)

```

```{r refreshment_plot, fig.cap = "Expected and perceived ratings of Refreshment \n errorbars indicate 95% CI (1.96 SE)"}


refreshment_tib <-refresh_dat %>%
  pivot_longer(cols = starts_with("refreshment"),
               names_to = "refreshment",
               values_to = "rating")%>%
  group_by(alcohol, focus,refreshment)%>%
  summarise(n = n(),
            meanB = mean(rating, na.rm = TRUE),
            sdB = sd(rating, na.rm = TRUE),
            ci_lo = meanB - 1.96 * sdB/sqrt(n),
            ci_hi = meanB + 1.96 * sdB/sqrt(n))%>%
  filter(!is.na(focus))

rating_labs <- c("perceived", "expected")
names(rating_labs) <- c("refreshment", "refreshmentE")

refreshment_plot <- ggplot(aes(x= focus, y = meanB, fill = alcohol), data = refreshment_tib ) +
  facet_grid(~ refreshment, 
             labeller = labeller(refreshment = rating_labs))+
   geom_bar(stat="identity", position=position_dodge())+
  geom_errorbar(aes(ymin=ci_lo, ymax=ci_hi), width=.2,
                 position=position_dodge(.9))+
  scale_y_continuous(name="refreshment", 
                     limits=c(0, 100), 
                     breaks =   seq(0,100, 25)) +
  scale_x_discrete(name = "focus" )+
  scale_fill_manual(values = gender_pal) +
  theme_minimal()

ggplotly(refreshment_plot)

```

## Liking

- no effect of focus or alcohol content on expected or perceived liking

```{r liking_mediate}
liking_dat <- D3_dat%>%
  dplyr::select(subject, alcohol, focus, condition, likingE, liking)
   # prep dataset

# model m A --> M
mlm <- lm(likingE ~ focus*alcohol, data = liking_dat)

# model A--> B
mly <-lm(liking ~ likingE + focus*alcohol,  data = liking_dat)


broom::tidy(mlm)%>%
  kable(digits = 3, caption = "effect of alcohol and focus on expected liking")%>%
  kable_styling(full_width = TRUE)

med_liking_focusH <- mediate(mlm, mly, 
                            sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "likingE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "hedonic")

summary(med_liking_focusH)
plot(med_liking_focusH)

med_liking_focusU <- mediate(mlm, mly, 
                            sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "likingE",
                            covariates = "alcohol",
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "utilitarian")

summary(med_liking_focusU)
plot(med_liking_focusU)

med_liking_alcohol <- mediate(mlm, mly, 
                              sims = 1000, 
                              boot.ci.type = "perc", 
                              treat = "alcohol", 
                              mediator = "likingE",
                              robustSE = TRUE, 
                              boot = TRUE,
                              conf.level = 0.95, 
                              covariates = "focus", 
                              control.value = "alcoholic", 
                              treat.value = "non-alcoholic")

summary(med_liking_alcohol)
plot(med_liking_alcohol)

```

```{r liking_plot, fig.cap = "Expected and perceived ratings of liking \n errorbars indicate 95% CI (1.96 SE)"}

liking_tib <-liking_dat %>%
  pivot_longer(cols = starts_with("liking"),
               names_to = "liking",
               values_to = "rating")%>%
  group_by(alcohol, focus,liking)%>%
  summarise(n = n(),
            meanB = mean(rating, na.rm = TRUE),
            sdB = sd(rating, na.rm = TRUE),
            ci_lo = meanB - 1.96 * sdB/sqrt(n),
            ci_hi = meanB + 1.96 * sdB/sqrt(n))%>%
  filter(!is.na(focus))

rating_labs <- c("perceived", "expected")
names(rating_labs) <- c("liking", "likingE")

liking_plot <- ggplot(aes(x= focus, y = meanB, fill = alcohol), data = liking_tib ) +
  facet_grid(~ liking, 
             labeller = labeller(liking = rating_labs))+
   geom_bar(stat="identity", position=position_dodge())+
  geom_errorbar(aes(ymin=ci_lo, ymax=ci_hi), width=.2,
                 position=position_dodge(.9))+
  scale_y_continuous(name="liking", 
                     limits=c(0, 100), 
                     breaks =   seq(0,100, 25)) +
  scale_x_discrete(name = "focus" )+
  scale_fill_manual(values = gender_pal) +
  theme_minimal()

ggplotly(liking_plot)

```



## Body
- alcoholic beer rated as having fuller body vs. non-alcoholic beer, however not mediated by expectations of body
-no effect of focus on expected or perceived body

```{r body_mediate}
body_dat <- D3_dat%>%
  dplyr::select(subject, alcohol, focus, condition, bodyE, body)
   # prep dataset

# model m A --> M
mbom <- lm(bodyE ~ focus*alcohol, data = body_dat)

# model A--> B
mboy <-lm(body ~ bodyE + focus*alcohol,  data = body_dat)

broom::tidy(mbom)%>%
  kable(digits = 3, caption = "effect of alcohol and focus on expected body") %>%
  kable_styling(full_width = TRUE)

med_body_focusH <- mediate(mbom, mboy,
                          sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "bodyE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "hedonic")

summary(med_body_focusH)

plot(med_body_focusH)

med_body_focusU <- mediate(mbom, mboy,
                          sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "bodyE",
                            covariates = "alcohol",
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "utilitarian")

summary(med_body_focusU)

plot(med_body_focusU)

med_body_alcohol <- mediate(mbom, mboy,
                             sims = 1000, 
                              boot.ci.type = "perc", 
                              treat = "alcohol", 
                              mediator = "bodyE",
                              robustSE = TRUE, 
                              boot = TRUE,
                              conf.level = 0.95, 
                              covariates = "focus", 
                              control.value = "alcoholic", 
                              treat.value = "non-alcoholic")

summary(med_body_alcohol)
plot(med_body_alcohol)

```

```{r body_plot, fig.cap = "Expected and perceived ratings of body\n errorbars indicate 95% CI (1.96 SE) "}

body_tib <-body_dat %>%
  pivot_longer(cols = starts_with("body"),
               names_to = "body",
               values_to = "rating")%>%
  group_by(alcohol, focus,body)%>%
  summarise(n = n(),
            meanB = mean(rating, na.rm = TRUE),
            sdB = sd(rating, na.rm = TRUE),
            ci_lo = meanB - 1.96 * sdB/sqrt(n),
            ci_hi = meanB + 1.96 * sdB/sqrt(n))%>%
  filter(!is.na(focus))

rating_labs <- c("perceived", "expected")
names(rating_labs) <- c("body", "bodyE")

body_plot <-ggplot(aes(x= focus, y = meanB, fill = alcohol), data = body_tib ) +
  facet_grid(~ body, 
             labeller = labeller(body = rating_labs))+
   geom_bar(stat="identity", position=position_dodge())+
  geom_errorbar(aes(ymin=ci_lo, ymax=ci_hi), width=.2,
                 position=position_dodge(.9))+
  scale_y_continuous(name="body", 
                     limits=c(0, 100), 
                     breaks =   seq(0,100, 25)) +
  scale_x_discrete(name = "focus" )+
  scale_fill_manual(values = gender_pal) +
  theme_minimal()

ggplotly(body_plot)

```



# Post - ingestive experience

## Satisfaction
- no effect of focus and alcohol content on expected satisfaction
- participants rated  perceived satisfaction lower when they drank non-alcoholic beer
- effect of alcohol on perceived satisfaction not mediated by expected satisfaction 

```{r satis_plot, fig.cap = "Expected and perceived ratings of satisfaction\n errorbars indicate 95% CI (+/- 1.96 SE)"}

satis_tib <-satis_dat %>%
  pivot_longer(cols = starts_with("satis"),
               names_to = "satis",
               values_to = "rating")%>%
  group_by(alcohol, focus,satis)%>%
  summarise(n = n(),
            meanB = mean(rating, na.rm = TRUE),
            sdB = sd(rating, na.rm = TRUE),
            ci_lo = meanB - 1.96 * sdB/sqrt(n),
            ci_hi = meanB + 1.96 * sdB/sqrt(n))%>%
  filter(!is.na(focus))

rating_labs <- c("perceived", "expected")
names(rating_labs) <- c("satis", "satisE")

satis_plot<-ggplot(aes(x= focus, y = meanB, fill = alcohol), data = satis_tib ) +
  facet_grid(~ satis, 
             labeller = labeller(satis = rating_labs))+
   geom_bar(stat="identity", position=position_dodge())+
  geom_errorbar(aes(ymin=ci_lo, ymax=ci_hi), width=.2,
                 position=position_dodge(.9))+
  scale_y_continuous(name="satisfaction", 
                     limits=c(0, 100), 
                     breaks =   seq(0,100, 25)) +
  scale_x_discrete(name = "focus" )+
  scale_fill_manual(values = gender_pal) +
  theme_minimal()

ggplotly(satis_plot)

```

```{r satis_mediate}

# model m A --> M
msm <- lm(satisE ~ focus*alcohol, data = satis_dat)

# model A--> B
msy <-lm(satis ~ satisE + focus*alcohol,  data = satis_dat)

broom::tidy(msm)%>%
  kable(digits = 3, caption = "effect of alcoholand focus on expected satisfaction")%>%
  kable_styling(full_width = TRUE)

med_satis_focusU <- mediate(msm, msy, 
                           sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "satisE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "utilitarian")

summary(med_satis_focusU)
plot(med_satis_focusU)

med_satis_focusH <- mediate(msm, msy, 
                           sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "satisE",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "hedonic")

summary(med_satis_focusH)
plot(med_satis_focusH)

med_satis_alcohol <- mediate(msm, msy, 
                             sims = 1000, 
                              boot.ci.type = "perc", 
                              treat = "alcohol", 
                              mediator = "satisE",
                              robustSE = TRUE, 
                              boot = TRUE,
                              conf.level = 0.95, 
                              covariates = "focus", 
                              control.value = "alcoholic", 
                              treat.value = "non-alcoholic")

summary(med_satis_alcohol)
plot(med_satis_alcohol)

```



## Willingness to pay
- no effect of focus on willingness to pay
- effect of alcoholcontent on wtp ( pp would pay slightly more for alcoholic beer)

```{r wtp_mediate}

# model m A --> M
mwm <- lm(satis ~ focus*alcohol, data = satis_dat)

# model A--> B
mwy <-lm(wtp ~ satis + focus*alcohol,  data = satis_dat)


med_wtp_focusH <- mediate(mwm, mwy, 
                          sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "satis",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "hedonic")

summary(med_wtp_focusH)
plot(med_wtp_focusH)

med_wtp_focusU <- mediate(mwm, mwy, 
                          sims = 1000, 
                            boot = TRUE,
                            boot.ci.type = "perc", 
                            treat = "focus", 
                            mediator = "satis",
                            covariates = "alcohol", 
                            robustSE = TRUE,  
                            conf.level = 0.95,
                            control.value = "control", 
                            treat.value = "utilitarian")

summary(med_wtp_focusU)
plot(med_wtp_focusU)

med_wtp_alcohol <- mediate(mwm, mwy, 
                           sims = 1000, 
                              boot.ci.type = "perc", 
                              treat = "alcohol", 
                              mediator = "satis",
                              robustSE = TRUE, 
                              boot = TRUE,
                              conf.level = 0.95, 
                             covariates = "focus",
                              control.value = "alcoholic", 
                              treat.value = "non-alcoholic")

summary(med_wtp_alcohol)
plot(med_wtp_alcohol)

```

```{r wtp_comparison}


wtp_model <- robust::lmRob(wtp ~ focus * alcohol, data = satis_dat)
summary(wtp_model)

wtp_tib <- satis_dat %>%
  group_by(focus, alcohol) %>%
  summarise(n = n(),
            mean_wtp = mean(wtp, na.rm = TRUE), 
            sd_wtp = sd(wtp, na.rm = TRUE), 
            ci_lo = mean_wtp - 1.96 * (sd_wtp/sqrt(n)),
            ci_high = mean_wtp + 1.96 *(sd_wtp/sqrt(n)))

wtp_tib %>%
  kable(digits = 2, caption = "Participants' mean willingness to pay in different alcohol and focus conditions.") %>%
  kable_styling(full_width = TRUE)



```
```{r wtp_plot, fig.cap= "Participants' willingness to pay for alcoholic and non-alcoholic beer. Error bars indicate confidence intervals (+/- 1.96 SE)"}
wtp_bar <-ggplot(aes(x=focus, 
           y = mean_wtp, 
           fill = alcohol), 
           data= wtp_tib)+
  geom_bar(stat="identity", position=position_dodge())+
  geom_errorbar(aes(ymin=ci_lo, ymax=ci_high), width=.2,
                 position=position_dodge(.9))+
  scale_y_continuous(name="willingness to pay (£)", 
                     limits=c(0, 5), 
                     breaks =   seq(0,5, 1)) +
  scale_x_discrete(name = "focus" )+
  scale_fill_manual(values = gender_pal) +
  theme_minimal()

wtp_bar

```


## Cognitive Performance

Participants' cognitive performance was assessed using the inspection time task (10.1016/j.neuroimage.2004.03.047) which measures participants'information processing. Participants completed the task just before, 30 minutes and 60 minutes after consumption. 

-pp performance improves as duration of stimulus increases
- effect of alcohol, stimulus duration and stage
- interactions: 
  alcohol*stimulus
  stimulus*stage
  alcohol\*stimulus\*stage
- no effect of focus



```{r GC_performance}

# these are two methods of analysis, should do the same thing, buttakes too long to run

# m_itt <- lmerTest::lmer(correct ~ focus * alcohol *stage *stimulus + (stage*stimulus| subject), data=itt_dat, REML=F)
# 
# summary(m_itt)

# contrasts

itt_afx <- afex::aov_4(correct ~ focus*alcohol*stage*stimulus  + (stimulus*stage|subject), data = itt_dat)
summary(itt_afx)

# need to take effects apart and set contrasts

# the main effect of alcohol

alcohol_emm <- emmeans::emmeans(itt_afx, ~alcohol, model = "multivariate")
alcohol_emm # shows us the means



# the main effect of stage
stage_emm <- emmeans::emmeans(itt_afx, ~stage, model = "multivariate")
stage_emm
emmeans::contrast(stage_emm, method = "trt.vs.ctrl", ref = 1, adjust = "holm")

#main effect of stimulus
stimulus_emm <- emmeans::emmeans(itt_afx, ~stimulus, model = "multivariate")
stimulus_emm

emmeans::contrast(stimulus_emm, method = "poly", adjust = "holm")

# interaction stimulus:stage

inter_emm <- emmeans::emmeans(itt_afx, c("stage", "stimulus"), model = "multivariate")
inter_emm

emmeans::contrast(
  inter_emm,
  c(stage = "trt.vs.ctrl", stimulus = "poly"),
  rel = 1,
  adjust = "holm"
  )
```

```{r itt_plot, fig.cap= "Participants' cognitive performance", fig.width=1200}

itt_dat$stimulus <- as.factor(itt_dat$stimulus) %>%
  fct_relevel(.,c("stim1", "stim2", "stim3", "stim4", "stim5", "stim6", "stim7", "stim8", "stim9", "stim10", "stim11", "stim12","stim13"))


itt_plot<-ggplot(data = itt_dat, aes(x = stimulus, y = correct, color = alcohol))+
  facet_grid(rows = vars(focus),
             cols = vars(stage))+
  stat_summary(fun=mean, geom="point") +
  scale_y_continuous(name="% correct", limits=c(0.5, 1.0), breaks = seq(0.5,1,0.15)) +
  scale_x_discrete(name = "stimulus duration\n(ms)", labels =c("19", "25", "31", "37", "44", "50", "62", "75", "87", "100", "125", "150", "200") )+ 
  scale_color_manual(values = gender_pal) +
  theme(axis.text.x = element_text( color="black", 
                           size=2, angle=45))+
  theme_minimal()

ggplotly(itt_plot, height = 500, width=1200)

```


## Mood

```{r mood_plot, fig.cap="Participants'mood accross the stages and conditions"}
mood_data<- mood_dat %>%
  dplyr::select(subject, stage, calm, content, alert)%>%
  pivot_longer(cols = c(calm, content, alert),
               names_to = "factor",
               values_to = "rating")%>%
  mutate(condition = subject%/% 1000)%>%
  mutate(alcohol = if_else((condition%%2)==1, "alcoholic", "non-alcoholic"))%>%
  mutate(focus = case_when(condition == 1 ~ 'control',
                           condition == 2 ~ 'control',
                           condition == 3 ~ 'hedonic',
                           condition == 4 ~ 'hedonic',
                           condition == 5 ~ 'utilitarian',
                           condition == 6 ~ 'utilitarian'))

ggplot(data = mood_data, aes(x = stage, y = rating, color = alcohol))+
    facet_grid(rows = vars(focus),
             cols = vars(factor))+
  stat_summary(fun=mean, geom="point") +
  scale_y_continuous(name="rating", limits=c(35, 48), breaks = seq(0,50,5)) +
  scale_x_discrete(name = "stage", labels = c("1", "2", "3") )+ 
  scale_color_manual(values = gender_pal) +
  theme(axis.text.x = element_text( color="black", 
                           size=2, angle=45))+
  theme_light()


```
```{r analysis, include=FALSE}

mood_data$focus <- as.factor(mood_data$focus)

# afex mixed effects model
mood_afx <- afex::aov_4(rating ~ focus*alcohol*stage*factor  + (factor*stage|subject), data = mood_data)
summary(mood_afx)


# main effect stage

stage_emm <- emmeans::emmeans(mood_afx, "stage", model = "multivariate")
stage_emm

emmeans::contrast(
  stage_emm,
  method = "pairwise",
  adjust = "holm"
  )

# main effect mood
fact_emm <- emmeans::emmeans(mood_afx, "factor", model = "multivariate")
fact_emm

emmeans::contrast(
  fact_emm,
  method = "pairwise",
  adjust = "holm"
  )



# interaction focus:alcohol

foc_alc_emm <- emmeans::emmeans(mood_afx, c("focus", "alcohol"), model = "multivariate")
foc_alc_emm

emmeans::contrast(
  foc_alc_emm,
  interaction = c(focus = "trt.vs.ctrl", alcohol = "pairwise"),
  ref = 1,
  adjust = "holm"
  )

afex::afex_plot(mood_afx,
                x = "focus",
                trace = "alcohol",
                mapping = "colour"
                ) +
  theme_minimal()

#interaction mood:stage
fact_stage_emm <- emmeans::emmeans(mood_afx, c("factor", "stage"), model = "multivariate")
fact_stage_emm

emmeans::contrast(
  fact_stage_emm,
  interaction = c(stage = "pairwise", fact = "pairwise"),
  adjust = "holm"
  )

afex::afex_plot(mood_afx,
                x = "stage",
                trace = "factor",
                mapping = "colour"
                ) +
  theme_minimal()

#interaction alcohol:factor:stage

fact_stage_alc_emm <- emmeans::emmeans(mood_afx, c("factor", "alcohol", "stage"), model = "multivariate")
fact_stage_alc_emm

emmeans::contrast(
  fact_stage_alc_emm,
  interaction = c(stage = "poly", fact = "pairwise", alcohol = "pairwise"),
  adjust = "holm"
  )

afex::afex_plot(mood_afx,
                x = "stage",
                trace = "alcohol",
                mapping = "colour",
                panel = "factor"
                ) +
  theme_minimal()
```
Assessing the effects of alcohol content and focus on mood, we observed main effect of mood type, main effect of stage. We have also observed interactions between focus and alcohol, mood and stage and a three-way intearction between mood, alcohol and stage. We will briefly report all main effects and interactions but will focus on the interpretation of the three-way interaction and the two-way intercation between focus and alcohol content.

### main effect of mood

There was a significant main effect of factor (from the Bond-Lader questionnaire: calm, content, alert) on ratings. Participants' ratings of feeling *calm* were significantly lower than feelings related to *content* and *alertness*. Participants also rated feelings of *alertness* significantly higher than feelings of *calm* or *content*. Feeling *content* was rated significantly higher than feeling *calm*, but significantly lower than feeling *alert*. **careful--> interactions!!** 

### main effect of stage
There was a significant effect of stage on mood ratings. Mood (all three factors) was rated significantly higher in stage 3 than in stage 1, there was no difference between stage 1 and stage 2 or stage 2 and stage 3.  **careful--> interaction!!**

### **two-way interaction: focus*alcohol**
The ratings were affected by focus  and alcohol content of the beer. In the hedonic condition, compared to control condition, the ratings were significantly higher for participants who drank alcoholic beer. This difference, however was not present in the utilitarian condition.

### two-way interaction mood*stage
Interestingly, participants self-reported feeling more alert at the end (stage 3) of the experiment than at the beginning (stage 1). Participants also rated feeling less calm during the experiment (stages 2 and 3) than at the beginning. This was regardless of the conditions they were in. **careful interaction**


### **three-way interaction alcohol\*mood\*stage**
 Participants rated feeling more alert as the experiment progressed, more so in the alcoholic beer condition. 

