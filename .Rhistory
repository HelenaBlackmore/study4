labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1), "%")),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE)+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE)+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2)+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 1)+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3)+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 0.2,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 3,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_label(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 1,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_text(aes(label = c(round(perc,1))),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 1,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_text(aes(label =paste0(round(perc,1),"%") ),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 1,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 25),
breaks =   seq(0,25, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_text(aes(label =paste0(round(perc,1),"%") ),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 1,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 15),
breaks =   seq(0,15, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
head(data_q)
pp_over14units <-data_q%>%filter(units>14)%nrow()
pp_over14units <-data_q%>%filter(units>14)%>%nrow()
pp_over14units
min(data_q$units)
max(data_q$units)
summary_beer <- data_q %>%
pivot_longer(cols = starts_with("units"),  names_to = "al_id", values_to = "units") %>%
mutate(al_id = ifelse(al_id =="units", "all", "beer"))%>%
group_by(condition, al_id)%>%
summarize(units = mean(units))%>%
pivot_wider(names_from = al_id, values_from = units)%>%
mutate(perc= (beer/all)*100)%>%
pivot_longer(cols = c(all, beer), names_to = "alcohol", values_to = "units")
al_pal <- c( "#1d3557","#f4a261")
beer_prop <- ggplot(data=summary_beer,
aes(x=condition,
y=units,
fill = alcohol)) +
geom_bar(stat="identity",
position=position_dodge())+
geom_text(aes(label =paste0(round(perc,1),"%") ),
data = summary_beer %>%filter(alcohol == "beer"),
show.legend = FALSE,
size = 2,
nudge_x = 0.3,
nudge_y = 1,
color = "#1d3557" )+
scale_fill_manual(values = al_pal)+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 15),
breaks =   seq(0,15, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
labs( fill = "alcohol")+
theme_minimal()
ggplotly(beer_prop)
beer_plot<-ggplot(aes(x=condition,
y = units_beer,
group = condition),
data= data_q)+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="beer consumption\n(units)",
limits=c(0, 35),
breaks =   seq(0,35, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplotly(beer_plot)
# plot units alcohol consumption by condition
units_plot<-ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplotly(units_plot)
ggplotly(units_plot)
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(yintercept = 14,
show.legend = TRUE,
color = red,
line = dashed)+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(yintercept = 14,
show.legend = TRUE,
color = "red",
line = dashed)+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(yintercept = 14,
show.legend = TRUE,
color = "red",
line = "dashed")+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(aes(yintercept = 14, linetype = "maximum recommended alcohol consumption"),
color = "red")+
scale_linetype_manual(name = "limit", values = c(2, 2),
guide = guide_legend(override.aes = color = "red"))+
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(aes(yintercept = 14, linetype = "maximum recommended alcohol consumption"),
color = "red")+
scale_linetype_manual(name = "maximum recommended alcohol consumption", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("red"))))+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(aes(yintercept = 14, linetype = "maximum recommended alcohol consumption"),
color = "red")+
scale_linetype_manual(name = "14 units/week", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("red"))))+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(aes(yintercept = 14, linetype = "14 units/week"),
color = "red")+
scale_linetype_manual(name = "maximum recommended alcohol consumption", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("red"))))+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(aes(yintercept = 14, linetype = "14 units/week"),
color = "red")+
scale_linetype_manual(name = "maximum recommended alcohol consumption", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("red")), title.theme = element_text(size = 6)))+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
ggplot(aes(x=condition,
y = units,
group = condition),
data= data_q)+
geom_hline(aes(yintercept = 14, linetype = "14 units/week"),
color = "red")+
scale_linetype_manual(name = "max. recommended\nalcohol consumption", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("red")), title.theme = element_text(size = 8, face = "bold" ) ))+
geom_boxplot(fill= "#6c757d",
alpha = 0.5,
outlier.shape = NA) +
geom_jitter(shape=16,
position=position_jitter(0.2),
aes(color = gender))+
scale_y_continuous(name="alcohol consumption\n(units)",
limits=c(0, 75),
breaks =   seq(0,75, 5)) +
scale_x_discrete(name = "conditions",
limits = c("1", "2", "3", "4", "5", "6"))+
scale_color_manual(values = gender_pal) +
theme_minimal()
observed_gender<- xtabs(~ gender + condition , data = data_q,drop.unused.levels = TRUE)%>%
across(.cols = everything(), .fns = round())%>%
kable() %>%
kable_styling(full_width = TRUE)
xtabs(~ gender + condition , data = data_q,drop.unused.levels = TRUE)%>%
across(.cols = everything(), .fns = round(.,1))%>%
kable() %>%
kable_styling(full_width = TRUE)
xtabs(~ gender + condition , data = data_q,drop.unused.levels = TRUE)%>%
roun(across(.cols = everything()),1)%>%
kable() %>%
kable_styling(full_width = TRUE)
xtabs(~ gender + condition , data = data_q,drop.unused.levels = TRUE)%>%
round(across(.cols = everything()),1)%>%
kable() %>%
kable_styling(full_width = TRUE)
xtabs(~ gender + condition , data = data_q,drop.unused.levels = TRUE)%>%
kable(digits = 2) %>%
kable_styling(full_width = TRUE)
chi_test$expected %>%
kable(digits = 2)%>%
kable_styling(full_width = TRUE)
al_cons_lm <- lmRob(units ~ condition, data= data_q)
summary(al_cons_lm)
beer_cons_lm <-lmRob(units_beer ~ condition, data = data_q)
summary(beer_cons_lm)
str(al_cons_lm)
al_model<-summary(al_cons_lm)
beer_model<-summary(beer_cons_lm)
kable(digits = 2)%>%
fchg
str(al_model)
al_model$coefficients
al_model$terms
al_model
al_cons_model
al_cons_lm
anova(al_cons_lm)
str(anova(al_cons_lm))
anova(al_cons_lm)$RobustF
beer_a<-anova(beer_cons_lm)
al_a<-anova(al_cons_lm)
